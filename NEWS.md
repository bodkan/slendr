# *slendr* 0.1 (upcoming first public release)

## New functionality

- Geographic landscapes and coordinate systems are no longer tied to a geographic location on Earth and can be fully abstract (including completely arbitrary shapes of the "continents", geographic barriers etc.).

- New set operations for manipulating spatial regions: `join()`, `overlap()`, `subtract()`. These can be used to build more complex population boundaries and geographic regions from smaller ones.

- New [shiny](http://shiny.rstudio.com)-based interactive exploration "app": `explore()`. The functions accepts a compiled `slendr_model` object (i.e. a formal configuration of spatial population dynamics and gene flow events) and the package will spawn a browser app with a time slider. This can be used to inspect the model spatial dynamics interactively before they are sent over to the SLiM side.

-  A new function `distance()` for computing distances between geographic objects in the package (either between their borders or centroids) has been implemented.

- A small utility function `dimension()` which calculates the dimension of the world map in the "real" projected units (i.e. meters) has been added.

- A new function `area()` has for calculating the geographic area covered by any object of the class `slendr` has been implemented.

- It is now possible to define models in forward or backwards direction, depending on what is more convenient for the user and the scenario that is being modeled. The direction of time is automatically detected and translated to SLiM's units of generations in the forward direction. The implementation of this features might be a bit wonky in some aspects and more testing is required.

- Simulations of marine species are now possible. This required adding a single argument `aquatic = TRUE` to the `population()` call which instructs the population range rendering procedure during compilation to "invert' intersection with landscape features (subtracting land instead of water, which is done for terrestrial species).

- Any simulation can now have multiple "ancestral" populations (i.e. populations without an immediate ancestor created by `sim.addSubpop()`). Until now, all populations had to trace their ancestry to a single ancestor (a leftover of a hard-coded requirement from the very first version of the code).

- A function `resize()` for scheduling changes in population size (in a single step, or as an exponential growth/shrinking) is implemented.

- A new `shrink()` function (analogous to `expand()`) is implemented.

- Spatial interaction distances (translated to `maxDistance` on the SLiM side) as well as offspring distances from parents (i.e. the standard deviations of their normal distributions) can now be specified for each population individually. The users can still provide default values for all populations (or just those which did not have their own dedicated parameter values) in the main `compile()` call. These parameters can also change dynamically over time by calling the `dispersal()` function.

- Two knew vignettes have been added. [One](../articles/grid_example.html) demonstrates a simple use case of simulating the history of populations as demes laid out on a regular abstract grid. The [other one](../articles/spatial_interactions.html) demonstrates the spatial interaction dynamics described in the previous point.

## Changes to the R interface

- Renamed `admixture()` to `geneflow()`.

- The number of intermediate "spatial snapshots" generated by `move()` and `expand()/shrink()` is now determined iteratively instead of forcing the user to specify this by themselves (which is something they would have to do manually anyway and was very annoying to deal with). If the user specifies the integer parameter `snapshots`, the search is not performed and the specified value is used to generate intermediate spatial maps.

## Changes to the SLiM backend

- Significant overhaul of the entire [SLiM layer](https://github.com/bodkan/slendr/blob/main/inst/extdata/backend.slim). Most importantly, complex and ugly hacks approximating dataframe behavior using SLiM matrices and custom functions are completely replaced by Dictionaries. The intention of the SLiM backend is to be as easy to understand as possible and as transparent as possible. If something could be written more elegantly or in a simpler way, please file a GitHub issue as I considered this a bug.

## Other changes

- More than a hundred new unit tests checking the consistency of the R interface (misspecified event times, etc.) as well as the correctness of the SLiM simulation runs programmed by *slendr*.
