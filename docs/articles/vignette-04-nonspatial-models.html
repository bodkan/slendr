<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<title>Traditional, non-spatial models • slendr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png">
<link rel="icon" type="”image/svg+xml”" href="../favicon.svg">
<link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png">
<link rel="icon" sizes="any" href="../favicon.ico">
<link rel="manifest" href="../site.webmanifest">
<script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet">
<script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet">
<link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet">
<script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Traditional, non-spatial models">
</head>
<body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">slendr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0.9000</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto">
<li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-question-circle"></span> Reference</a></li>
<li class="active nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles">
<li><a class="dropdown-item" href="../articles/vignette-00-installation.html">Installation instructions</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-01-tutorial.html">Introduction and basic tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-02-grid-model.html">Demes on a regular spatial grid</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-03-interactions.html">Programming dispersion dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-04-nonspatial-models.html">Traditional non-spatial models</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-05-tree-sequences.html">Tree sequence processing and statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-06-locations.html">Spatially annotated tree sequences</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-07-backends.html">Simulating data with SLiM and msprime backends</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-08-nonslendr-tskit.html">Analyzing non-slendr tree sequences</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-09-paper.html">Examples from the slendr paper</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-10-tracts.html">Extracting true ancestry tracts</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-11-extensions.html">Extending models with custom SLiM code</a></li>
  </ul>
</li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul>
<ul class="navbar-nav">
<li class="nav-item"><a class="external-link nav-link" href="https://github.com/bodkan/slendr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/fleventy5"><span class="fa fa-twitter"></span></a></li>
      </ul>
</div>


  </div>
</nav><div class="container template-article">




<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Traditional, non-spatial models</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/bodkan/slendr/blob/HEAD/vignettes/vignette-04-nonspatial-models.Rmd" class="external-link"><code>vignettes/vignette-04-nonspatial-models.Rmd</code></a></small>
      <div class="d-none name"><code>vignette-04-nonspatial-models.Rmd</code></div>
    </div>

    
    
<p>The biggest selling point of the <em>slendr</em> package is that you
can program spatiotemporal population genetics models in R and have them
execute automatically in SLiM. However, there are several reasons why
you might be interested in using <em>slendr</em> even for non-spatial
models. First, R is a language that many scientists already know, and
being able to simulate data from the comfort of an R interface
significantly lowers the barrier of entry. Second, because
<em>slendr</em> makes SLiM appear almost as if it were just another R
library, running simulations (spatial <em>and</em> non-spatial), fitting
models, exploring parameter grids, calculating statistics, and
visualization of results can be all be performed without leaving the R
interface.</p>
<p>In this vignette, we will demonstrate how to program non-spatial
models in <em>slendr</em>. However, we should start by noting that there
is almost no difference between code for non-spatial and spatial models
in <em>slendr</em>. The only visible difference is that spatial models
include a <code>map =</code> argument in the <code><a href="../reference/population.html">population()</a></code>
constructor function of ancestral population(s), and non-spatial models
do not. That’s it, that’s the difference. Switching between spatial and
non-spatial models is performed internally by the package, without any
user intervention.</p>
<p>To make the comparison clearer, we will use the example from the
<em>slendr</em> <a href="https://github.com/bodkan/slendr" class="external-link">landing
page</a>, but we will implement it in a non-spatial context (i.e., as a
traditional random mating simulation).</p>
<p>First, let’s define population objects, splits, and other demographic
events (note the missing <code>map</code> argument, which is set to
<code>FALSE</code> by default):</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bodkan/slendr" class="external-link">slendr</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/init_env.html">init_env</a></span><span class="op">(</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; The interface to all required Python modules has been activated.</span></span></code></pre>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="co"># African ancestral population</span></span>
<span><span class="va">afr</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"AFR"</span>, time <span class="op">=</span> <span class="fl">100000</span>, N <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># first migrants out of Africa</span></span>
<span><span class="va">ooa</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"OOA"</span>, parent <span class="op">=</span> <span class="va">afr</span>, time <span class="op">=</span> <span class="fl">60000</span>, N <span class="op">=</span> <span class="fl">500</span>, remove <span class="op">=</span> <span class="fl">23000</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/resize.html">resize</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">2000</span>, time <span class="op">=</span> <span class="fl">40000</span>, how <span class="op">=</span> <span class="st">"step"</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Eastern hunter-gatherers</span></span>
<span><span class="va">ehg</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"EHG"</span>, parent <span class="op">=</span> <span class="va">ooa</span>, time <span class="op">=</span> <span class="fl">28000</span>, N <span class="op">=</span> <span class="fl">1000</span>, remove <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># European population</span></span>
<span><span class="va">eur</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"EUR"</span>, parent <span class="op">=</span> <span class="va">ehg</span>, time <span class="op">=</span> <span class="fl">25000</span>, N <span class="op">=</span> <span class="fl">2000</span><span class="op">)</span> <span class="op"><a href="../reference/pipe.html">%&gt;%</a></span></span>
<span>  <span class="fu"><a href="../reference/resize.html">resize</a></span><span class="op">(</span>N <span class="op">=</span> <span class="fl">10000</span>, how <span class="op">=</span> <span class="st">"exponential"</span>, time <span class="op">=</span> <span class="fl">5000</span>, end <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Anatolian farmers</span></span>
<span><span class="va">ana</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"ANA"</span>, time <span class="op">=</span> <span class="fl">28000</span>, N <span class="op">=</span> <span class="fl">3000</span>, parent <span class="op">=</span> <span class="va">ooa</span>, remove <span class="op">=</span> <span class="fl">4000</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Yamnaya steppe population</span></span>
<span><span class="va">yam</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/population.html">population</a></span><span class="op">(</span><span class="st">"YAM"</span>, time <span class="op">=</span> <span class="fl">7000</span>, N <span class="op">=</span> <span class="fl">500</span>, parent <span class="op">=</span> <span class="va">ehg</span>, remove <span class="op">=</span> <span class="fl">2500</span><span class="op">)</span></span></code></pre></div>
<p>We can define gene flow events in the same way as we did for the
spatial model:</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">gf</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span></span>
<span>  <span class="fu"><a href="../reference/gene_flow.html">gene_flow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">ana</span>, to <span class="op">=</span> <span class="va">yam</span>, rate <span class="op">=</span> <span class="fl">0.5</span>, start <span class="op">=</span> <span class="fl">6500</span>, end <span class="op">=</span> <span class="fl">6400</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/gene_flow.html">gene_flow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">ana</span>, to <span class="op">=</span> <span class="va">eur</span>, rate <span class="op">=</span> <span class="fl">0.5</span>, start <span class="op">=</span> <span class="fl">8000</span>, end <span class="op">=</span> <span class="fl">6000</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="../reference/gene_flow.html">gene_flow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">yam</span>, to <span class="op">=</span> <span class="va">eur</span>, rate <span class="op">=</span> <span class="fl">0.75</span>, start <span class="op">=</span> <span class="fl">4000</span>, end <span class="op">=</span> <span class="fl">3000</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>The compilation step is also the same. The only (internal) difference
is that we skip the rasterization of vector maps that is performed for
spatial models in order to control and restrict population
boundaries:</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/compile_model.html">compile_model</a></span><span class="op">(</span></span>
<span>  populations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">afr</span>, <span class="va">ooa</span>, <span class="va">ehg</span>, <span class="va">eur</span>, <span class="va">ana</span>, <span class="va">yam</span><span class="op">)</span>,</span>
<span>  gene_flow <span class="op">=</span> <span class="va">gf</span>, generation_time <span class="op">=</span> <span class="fl">30</span>,</span>
<span>  time_units <span class="op">=</span> <span class="st">"years before present"</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Using the <code><a href="../reference/plot_map.html">plot_map()</a></code> function doesn’t make sense, as
there are no spatial maps to plot. However, we can still plot the
demographic graph, verifying that the model has been specified correctly
using the function <code><a href="../reference/plot_model.html">plot_model()</a></code> as shown below.</p>
<p>Let’s say we also want to schedule specific sampling events at
specific times (which record only specified individuals in a tree
sequence). We can use <code><a href="../reference/schedule_sampling.html">schedule_sampling()</a></code> to do just
that:</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">samples</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/schedule_sampling.html">schedule_sampling</a></span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span>, <span class="fl">12000</span>, <span class="fl">20000</span>, <span class="fl">35000</span>, <span class="fl">39000</span>, <span class="fl">43000</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eur</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ehg</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yam</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ana</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ooa</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">afr</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
<p>Because it’s not just the model itself that’s useful to visually
verify (which is the main purpose of <code><a href="../reference/plot_model.html">plot_model()</a></code>) but also
the sampling scheme, <em>slendr</em> makes it possible to overlay the
numbers of individuals scheduled for tree-sequence recording from each
lineage at each timepoint:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/plot_model.html">plot_model</a></span><span class="op">(</span><span class="va">model</span>, samples <span class="op">=</span> <span class="va">samples</span><span class="op">)</span></span></code></pre></div>
<p><img src="vignette-04-nonspatial-models_files/figure-html/non-spatial-graph_sampling-1.png" width="420"></p>
<p>Even the final step—execution of the model in SLiM—is the same, using
the built-in <code><a href="../reference/slim.html">slim()</a></code> function:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_slim</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/slim.html">slim</a></span><span class="op">(</span><span class="va">model</span>, sequence_length <span class="op">=</span> <span class="fl">100000</span>, recombination_rate <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>Even for non-spatial models, this function still uses the same SLiM
back end script used for spatial models. The only difference is that all
spatial features are switched off, making the model run as a simple
random-mating simulation.</p>
<p>Given that we are running a non-spatial simulation, you might wonder
if it wouldn’t be more efficient to use a coalescent simulator. Indeed,
<em>slendr</em> also provides an alternative <em>msprime</em> back end
just for this purpose. We could run the exact same simulation with
<em>msprime</em> like this:</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts_msprime</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msprime.html">msprime</a></span><span class="op">(</span><span class="va">model</span>, sequence_length <span class="op">=</span> <span class="fl">100000</span>, recombination_rate <span class="op">=</span> <span class="fl">0</span><span class="op">)</span></span></code></pre></div>
<p>In fact, because both SLiM and <em>msprime</em> back ends save
outputs in a tree sequence format, we can analyse them using the same
tools. See <a href="https://slendr.net/articles/vignette-05-tree-sequences.html">this
vignette</a> for more information about tree sequence analysis with
<em>slendr</em>, and for more discussion on alternative simulation back
ends and more extensive examples of data analysis with tree sequences
you can read <a href="https://slendr.net/articles/vignette-07-backends.html">this
tutorial</a>.</p>
<div class="section level2">
<h2 id="extracting-parameters-from-a-model-or-tree-sequences">Extracting parameters from a model or tree sequences<a class="anchor" aria-label="anchor" href="#extracting-parameters-from-a-model-or-tree-sequences"></a>
</h2>
<p>In some situations (such as when model parameters are drawn from
random distributions and we need to know which parameters had been used
<em>after</em> the simulations), function
<code><a href="../reference/extract_parameters.html">extract_parameters()</a></code> can be used. This function peeks into
a <em>slendr</em> tree sequence object and extract parameters of the
original <em>slendr</em> model:</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/extract_parameters.html">extract_parameters</a></span><span class="op">(</span><span class="va">ts_msprime</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $splits</span></span>
<span><span class="co">#&gt;   pop parent    N   time remove</span></span>
<span><span class="co">#&gt; 1 AFR   &lt;NA&gt; 3000 100000     NA</span></span>
<span><span class="co">#&gt; 2 OOA    AFR  500  60000  23000</span></span>
<span><span class="co">#&gt; 3 EHG    OOA 1000  28000   6000</span></span>
<span><span class="co">#&gt; 5 ANA    OOA 3000  28000   4000</span></span>
<span><span class="co">#&gt; 4 EUR    EHG 2000  25000     NA</span></span>
<span><span class="co">#&gt; 6 YAM    EHG  500   7000   2500</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gene_flows</span></span>
<span><span class="co">#&gt;   from  to start  end rate</span></span>
<span><span class="co">#&gt; 1  ANA YAM  6500 6400 0.50</span></span>
<span><span class="co">#&gt; 2  ANA EUR  8000 6000 0.50</span></span>
<span><span class="co">#&gt; 3  YAM EUR  4000 3000 0.75</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $resizes</span></span>
<span><span class="co">#&gt;   pop         how     N  time end</span></span>
<span><span class="co">#&gt; 1 OOA        step  2000 40000  NA</span></span>
<span><span class="co">#&gt; 2 EUR exponential 10000  5000   0</span></span></code></pre>
<p>For completeness, although this isn’t relevant in this example
either, the function can also get parameters from any compiled model.
For instance, we can check which parameters were used to compile the
built-in <em>slendr</em> introgression model by running:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">introgression_model</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/read_model.html">read_model</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/models/introgression"</span>, package <span class="op">=</span> <span class="st">"slendr"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="../reference/extract_parameters.html">extract_parameters</a></span><span class="op">(</span><span class="va">introgression_model</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; $splits</span></span>
<span><span class="co">#&gt;   pop parent    N    time remove</span></span>
<span><span class="co">#&gt; 1  CH   &lt;NA&gt;   10 6500000     NA</span></span>
<span><span class="co">#&gt; 2 AFR     CH   10 6000000     NA</span></span>
<span><span class="co">#&gt; 3 NEA    AFR   10  600000  40000</span></span>
<span><span class="co">#&gt; 4 EUR    AFR 5000   70000     NA</span></span>
<span><span class="co">#&gt; </span></span>
<span><span class="co">#&gt; $gene_flows</span></span>
<span><span class="co">#&gt;   from  to start   end rate</span></span>
<span><span class="co">#&gt; 1  NEA EUR 55000 45000 0.03</span></span></code></pre>
<p>As we can see, <code><a href="../reference/extract_parameters.html">extract_parameters()</a></code> returns a list of
data frames, one data frame for each aspect of a demographic model
(where applicable).</p>
</div>
<div class="section level2">
<h2 id="named-samples">Named samples<a class="anchor" aria-label="anchor" href="#named-samples"></a>
</h2>
<p>As an addendum, it is worth mentioning that in addition to
automatically naming recorded samples according to the format of
<code>"&lt;population&gt;_&lt;number&gt;"</code>, <em>slendr</em>
supports uniquely named samples. For instance, imagine that we want to
record an ancient individual representing a 45.000 years old hunter
gatherer known as Ust’-Ishim (Fu, _et al., Nature, 2014). We could
include this sample among our other, generically named, samples like
this:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">schedule_amh</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/schedule_sampling.html">schedule_sampling</a></span><span class="op">(</span></span>
<span>  <span class="va">model</span>,</span>
<span>  times <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">5000</span>, <span class="fl">12000</span>, <span class="fl">20000</span>, <span class="fl">35000</span>, <span class="fl">39000</span>, <span class="fl">43000</span><span class="op">)</span>,</span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">eur</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ehg</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">yam</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ana</span>, <span class="fl">3</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ooa</span>, <span class="fl">1</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">afr</span>, <span class="fl">1</span><span class="op">)</span></span>
<span><span class="op">)</span></span>
<span></span>
<span><span class="va">schedule_ui</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/schedule_sampling.html">schedule_sampling</a></span><span class="op">(</span><span class="va">model</span>, times <span class="op">=</span> <span class="fl">45000</span>, <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">ooa</span>, <span class="fl">1</span>, <span class="st">"Ust_Ishim"</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># bind the two tables together into a single schedule</span></span>
<span><span class="va">schedule</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">rbind</a></span><span class="op">(</span><span class="va">schedule_amh</span>, <span class="va">schedule_ui</span><span class="op">)</span></span></code></pre></div>
<p>Then we would simulate just like before:</p>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/msprime.html">msprime</a></span><span class="op">(</span><span class="va">model</span>, sequence_length <span class="op">=</span> <span class="fl">100000</span>, recombination_rate <span class="op">=</span> <span class="fl">0</span>, samples <span class="op">=</span> <span class="va">schedule</span><span class="op">)</span></span></code></pre></div>
<p>When we inspect the table of all recorded individuals, we can see
that the Ust’-Ishim individual is stored under its proper symbolic
name:</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ts_samples.html">ts_samples</a></span><span class="op">(</span><span class="va">ts</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt;         name  time pop</span></span>
<span><span class="co">#&gt; 1  Ust_Ishim 45000 OOA</span></span>
<span><span class="co">#&gt; 2      AFR_1 43000 AFR</span></span>
<span><span class="co">#&gt; 3      OOA_1 43000 OOA</span></span>
<span><span class="co">#&gt; 4      AFR_2 39000 AFR</span></span>
<span><span class="co">#&gt; 5      OOA_2 39000 OOA</span></span>
<span><span class="co">#&gt; 6      AFR_3 35000 AFR</span></span>
<span><span class="co">#&gt; 7      OOA_3 35000 OOA</span></span>
<span><span class="co">#&gt; 8      AFR_4 20000 AFR</span></span>
<span><span class="co">#&gt; 9      ANA_1 20000 ANA</span></span>
<span><span class="co">#&gt; 10     ANA_2 20000 ANA</span></span>
<span><span class="co">#&gt; 11     ANA_3 20000 ANA</span></span>
<span><span class="co">#&gt; 12     EHG_1 20000 EHG</span></span>
<span><span class="co">#&gt; 13     EUR_1 20000 EUR</span></span>
<span><span class="co">#&gt; 14     EUR_2 20000 EUR</span></span>
<span><span class="co">#&gt; 15     EUR_3 20000 EUR</span></span>
<span><span class="co">#&gt; 16     AFR_5 12000 AFR</span></span>
<span><span class="co">#&gt; 17     ANA_4 12000 ANA</span></span>
<span><span class="co">#&gt; 18     ANA_5 12000 ANA</span></span>
<span><span class="co">#&gt; 19     ANA_6 12000 ANA</span></span>
<span><span class="co">#&gt; 20     EHG_2 12000 EHG</span></span>
<span><span class="co">#&gt; 21     EUR_4 12000 EUR</span></span>
<span><span class="co">#&gt; 22     EUR_5 12000 EUR</span></span>
<span><span class="co">#&gt; 23     EUR_6 12000 EUR</span></span>
<span><span class="co">#&gt; 24     AFR_6  5000 AFR</span></span>
<span><span class="co">#&gt; 25     ANA_7  5000 ANA</span></span>
<span><span class="co">#&gt; 26     ANA_8  5000 ANA</span></span>
<span><span class="co">#&gt; 27     ANA_9  5000 ANA</span></span>
<span><span class="co">#&gt; 28     EUR_7  5000 EUR</span></span>
<span><span class="co">#&gt; 29     EUR_8  5000 EUR</span></span>
<span><span class="co">#&gt; 30     EUR_9  5000 EUR</span></span>
<span><span class="co">#&gt; 31     YAM_1  5000 YAM</span></span>
<span><span class="co">#&gt; 32     AFR_7     0 AFR</span></span>
<span><span class="co">#&gt; 33    EUR_10     0 EUR</span></span>
<span><span class="co">#&gt; 34    EUR_11     0 EUR</span></span>
<span><span class="co">#&gt; 35    EUR_12     0 EUR</span></span></code></pre>
<p>When we later compute summary statistics on tree sequences, this
makes referring to specific individuals even more convenient:</p>
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span><span class="fu"><a href="../reference/ts_f4ratio.html">ts_f3</a></span><span class="op">(</span><span class="va">ts</span>, A <span class="op">=</span> <span class="st">"AFR_1"</span>, B <span class="op">=</span> <span class="st">"EUR_1"</span>, C <span class="op">=</span> <span class="st">"Ust_Ishim"</span>, mode <span class="op">=</span> <span class="st">"branch"</span><span class="op">)</span></span></code></pre></div>
<pre><code><span><span class="co">#&gt; <span style="color: #949494;"># A tibble: 1 × 4</span></span></span>
<span><span class="co">#&gt;   A     B     C            f3</span></span>
<span><span class="co">#&gt;   <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span></span>
<span><span class="co">#&gt; <span style="color: #BCBCBC;">1</span> AFR_1 EUR_1 Ust_Ishim <span style="text-decoration: underline;">1</span>210.</span></span></code></pre>
</div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside>
</div>



    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Petr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer>
</div>





  </body>
</html>
