<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Spatio-temporal Population Genetics Simulations Using SLiM • slendr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Spatio-temporal Population Genetics Simulations Using SLiM">
<meta property="og:description" content="A framework for simulating spatially-explicit genomic
    data which leverages real cartographic information to programmatically
    and visually encode spatial population boundaries and temporal dynamics
    (i.e., population displacements and expansions) across a real geographic
    landscape, and specify population divergences and gene flow events based
    on an arbitrary admixture graph. Spatial demographic models are then
    compiled into a custom-built SLiM script which can be extended by
    the user to perform arbitrary simulations.">
<meta property="og:image" content="https://bodkan.net/stamp/logo.png">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">slendr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/tutorial.html">Introduction and tutorial</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/bodkan/
           /">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<hr>
<!-- README.md is generated from README.Rmd. Edit that file instead. -->
<div id="spatio-temporal-population-genetics-simulations-using-slim-" class="section level2">
<h2 class="hasAnchor">
<a href="#spatio-temporal-population-genetics-simulations-using-slim-" class="anchor"></a>Spatio-temporal Population Genetics Simulations Using SLiM <a href="https://bodkan.net/slendr"><img src="reference/figures/logo.png" align="right" height="139"></a>
</h2>
<p><strong>This software is still under development!</strong> I have been making a good progress towards the first beta version, but the package still has some way to go before being production ready.</p>
<p>That said, if you would like to learn more, or if you’re feeling brave and would like to test the package yourself, take a look at the <a href="https://bodkan.net/spannr/articles/tutorial.html">tutorial</a>. Note that getting it installed with all the geospatial dependencies can be a little bit tricky at this point (see the relevant section in the tutorial). If loading the package fails, check the error messages for missing software and install it using the package manager of your choice (on a Mac I recommend <em>homebrew</em>).</p>
<p>If you would like to stay updated with the developments:</p>
<ol>
<li><p>Click on the “Watch” button on the project’s <a href="https://www.github.com/bodkan/slendr">Github website</a>.</p></li>
<li><p>Follow me on <a href="https://www.twitter.com/fleventy5">Twitter</a>. I might post some updates once the software is a bit more ready.</p></li>
</ol>
<div id="installation" class="section level3">
<h3 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h3>
<p>For installation instructions, please take a look at the installation section <a href="https://bodkan.net/spannr/articles/tutorial.html#installation-and-setup-1">of the tutorial</a>. Note that you might need to install some non-R software dependencies first. At the very least, you will need the most recent version of the <a href="https://messerlab.org/slim/">SLiM software</a> (version 3.6 or later).</p>
</div>
<div id="example" class="section level3">
<h3 class="hasAnchor">
<a href="#example" class="anchor"></a>Example</h3>
<p>Here is a small demonstration of what <em>slendr</em> is designed to do. Note that this model is not supposed to recapitulate the history of any known species and serves just for demonstration purposes.</p>
<p>For a more complete example that is less abstract and demonstrates the usage of the package on a model of West Eurasian history, please see the <a href="https://bodkan.net/spannr/articles/tutorial.html">tutorial</a>.</p>
<p>We’re going to simulate a demographic history of several populations, including splits and geneflow events, defining the spatial boundaries of populations as well as their changing dynamics over time. We will then feed the model defined in R into SLiM and instruct it (using a back-end SLiM script provided by this package) to simulate data based on the model specification (step 7). Finally, we will generate some visualizations to make sure that the simulation proceeded as we wanted to (steps 8 and 9).</p>
<div id="1-setup-the-spatial-context-the-world-occupied-by-populations" class="section level4">
<h4 class="hasAnchor">
<a href="#1-setup-the-spatial-context-the-world-occupied-by-populations" class="anchor"></a>1. Setup the spatial context (“the world” occupied by populations)</h4>
<p>Note that in the world definition, we are explicitly stating which projected <a href="https://en.wikipedia.org/wiki/Spatial_reference_system">Coordinate Reference System</a> (CRS) will be used to represent landscape features, distances in kilometers, etc.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://github.com/bodkan/slendr">slendr</a></span><span class="op">)</span>

<span class="va">map</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/world.html">world</a></span><span class="op">(</span>
  xrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">15</span>, <span class="fl">60</span><span class="op">)</span>, <span class="co"># min-max longitude</span>
  yrange <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">65</span><span class="op">)</span>,  <span class="co"># min-max latitude</span>
  crs <span class="op">=</span> <span class="st">"EPSG:3035"</span>    <span class="co"># real projected CRS used internally</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="2-define-demographic-history-and-population-boundaries" class="section level4">
<h4 class="hasAnchor">
<a href="#2-define-demographic-history-and-population-boundaries" class="anchor"></a>2. Define demographic history and population boundaries</h4>
<p>Times are given in “units before present”, distances in kilometers. Note that for easier model definition, all coordinates of are specified by the user in geographic coordinate system (longitude, latitude), but are internally represented in a projected CRS.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">p1</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop1"</span>, time <span class="op">=</span> <span class="fl">35000</span>, N <span class="op">=</span> <span class="fl">700</span>,
  radius <span class="op">=</span> <span class="fl">600000</span>,    <span class="co"># radius of the circular range (in meters)</span>
  center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span>, <span class="co"># (longitude, latitude) coordinates of the center</span>
  map <span class="op">=</span> <span class="va">map</span>
<span class="op">)</span>

<span class="va">p2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop2"</span>, parent <span class="op">=</span> <span class="va">p1</span>, time <span class="op">=</span> <span class="fl">30000</span>, N <span class="op">=</span> <span class="fl">500</span>,
  center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span>, radius <span class="op">=</span> <span class="fl">300000</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/move.html">move</a></span><span class="op">(</span>
    trajectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">25</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">30</span><span class="op">)</span>, <span class="co"># trajectory of movement</span>
                      <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">40</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span><span class="op">)</span>,
    start <span class="op">=</span> <span class="fl">29000</span>, end <span class="op">=</span> <span class="fl">25000</span>, snapshots <span class="op">=</span> <span class="fl">30</span>
  <span class="op">)</span>

<span class="va">p3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop3"</span>, parent <span class="op">=</span> <span class="va">p2</span>, time <span class="op">=</span> <span class="fl">20000</span>, N <span class="op">=</span> <span class="fl">1000</span>,
  polygon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">53</span><span class="op">)</span>, <span class="co"># polygon range</span>
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">60</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">40</span>, <span class="fl">70</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">65</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">p4</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop4"</span>, parent <span class="op">=</span> <span class="va">p2</span>, time <span class="op">=</span> <span class="fl">15000</span>, N <span class="op">=</span> <span class="fl">800</span>,
  polygon <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">35</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">20</span>, <span class="fl">37</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">25</span>, <span class="fl">40</span><span class="op">)</span>,
                 <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">30</span>, <span class="fl">45</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">50</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">10</span>, <span class="fl">45</span><span class="op">)</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">p5</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/population.html">population</a></span><span class="op">(</span>
  name <span class="op">=</span> <span class="st">"pop5"</span>, parent <span class="op">=</span> <span class="va">p1</span>, time <span class="op">=</span> <span class="fl">10000</span>, N <span class="op">=</span> <span class="fl">1000</span>,
  center <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">25</span><span class="op">)</span>, radius <span class="op">=</span> <span class="fl">300000</span>
<span class="op">)</span> <span class="op">%&gt;%</span>
  <span class="fu"><a href="reference/move.html">move</a></span><span class="op">(</span> <span class="co"># population migration...</span>
    trajectory <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">33</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">40</span><span class="op">)</span><span class="op">)</span>,
    start <span class="op">=</span> <span class="fl">9000</span>, end <span class="op">=</span> <span class="fl">8000</span>,
    snapshots <span class="op">=</span> <span class="fl">20</span>
  <span class="op">)</span> <span class="op">%&gt;%</span> <span class="co"># ... followed by expansion</span>
  <span class="fu"><a href="reference/expand.html">expand</a></span><span class="op">(</span>by <span class="op">=</span> <span class="fl">2000000</span>, start <span class="op">=</span> <span class="fl">7000</span>, end <span class="op">=</span> <span class="fl">2000</span>, snapshots <span class="op">=</span> <span class="fl">10</span><span class="op">)</span></code></pre></div>
</div>
<div id="3-define-geneflow-events" class="section level4">
<h4 class="hasAnchor">
<a href="#3-define-geneflow-events" class="anchor"></a>3. Define geneflow events</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">geneflows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span>
  <span class="fu"><a href="reference/geneflow.html">geneflow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">p5</span>, to <span class="op">=</span> <span class="va">p4</span>, rate <span class="op">=</span> <span class="fl">0.25</span>, start <span class="op">=</span> <span class="fl">2000</span>, end <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>,
  <span class="fu"><a href="reference/geneflow.html">geneflow</a></span><span class="op">(</span>from <span class="op">=</span> <span class="va">p5</span>, to <span class="op">=</span> <span class="va">p3</span>, rate <span class="op">=</span> <span class="fl">0.6</span>, start <span class="op">=</span> <span class="fl">2000</span>, end <span class="op">=</span> <span class="fl">0</span><span class="op">)</span>
<span class="op">)</span></code></pre></div>
</div>
<div id="4-compile-the-model-to-a-set-of-configuration-files" class="section level4">
<h4 class="hasAnchor">
<a href="#4-compile-the-model-to-a-set-of-configuration-files" class="anchor"></a>4. Compile the model to a set of configuration files</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/compile.html">compile</a></span><span class="op">(</span>
  dir <span class="op">=</span> <span class="st">"/tmp/example-model"</span>, <span class="co"># location of serialized model data</span>
  populations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="va">p1</span>, <span class="va">p2</span>, <span class="va">p3</span>, <span class="va">p4</span>, <span class="va">p5</span><span class="op">)</span>,
  geneflows <span class="op">=</span> <span class="va">geneflows</span>,
  generation_time <span class="op">=</span> <span class="fl">30</span>,
  competition_dist <span class="op">=</span> <span class="fl">200e3</span>, <span class="co"># interaction distances (in meters)</span>
  mate_dist <span class="op">=</span> <span class="fl">200e3</span>, offspring_dist <span class="op">=</span> <span class="fl">50e3</span>,
  resolution <span class="op">=</span> <span class="fl">10000</span>  <span class="co"># how many meters per pixel?</span>
<span class="op">)</span></code></pre></div>
<p>Compiled model is kept as an R object which can be passed to different functions, most importantly the <code><a href="reference/slim.html">slim()</a></code> function shown below.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">model</span>
<span class="co">#&gt; slendr 'model' object </span>
<span class="co">#&gt; --------------------- </span>
<span class="co">#&gt; populations: pop1, pop2, pop3, pop4, pop5 </span>
<span class="co">#&gt; geneflow events: 2 </span>
<span class="co">#&gt; generation time: </span>
<span class="co">#&gt; number of spatial maps: 71 </span>
<span class="co">#&gt; resolution: 10000 km per pixel</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; configuration files in: /private/tmp/example-model </span>
<span class="co">#&gt; </span>
<span class="co">#&gt; A detailed model specification can be found in `$splits`, `$geneflows`,</span>
<span class="co">#&gt; `$maps`, `$populations`, and other components of the model object (for</span>
<span class="co">#&gt; a complete list see `names(&lt;model object&gt;)`). You can also examine</span>
<span class="co">#&gt; the serialized configuration files in the model directory.</span></code></pre></div>
</div>
<div id="5-visualize-the-model" class="section level4">
<h4 class="hasAnchor">
<a href="#5-visualize-the-model" class="anchor"></a>5. Visualize the model</h4>
<p>The package provides an [R shiny]-based browser app <code><a href="reference/explore.html">explore()</a></code> for checking the model dynamics interactively and visually.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/explore.html">explore</a></span><span class="op">(</span><span class="va">model</span><span class="op">)</span></code></pre></div>
<p>The function has two modes:</p>
<ol>
<li>Plotting spatial map dynamics:</li>
</ol>
<p><img src="reference/figures/shiny_maps.png"></p>
<ol>
<li>Displaying the demographic history graph (splits and geneflow events) embedded in the specified model:</li>
</ol>
<p><img src="reference/figures/shiny_graph.png"></p>
</div>
<div id="6-run-the-model-in-slim-in-batch-mode-in-this-case" class="section level4">
<h4 class="hasAnchor">
<a href="#6-run-the-model-in-slim-in-batch-mode-in-this-case" class="anchor"></a>6. Run the model in SLiM (in batch mode in this case)</h4>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/slim.html">slim</a></span><span class="op">(</span>
  <span class="va">model</span>, seq_length <span class="op">=</span> <span class="fl">1</span>, recomb_rate <span class="op">=</span> <span class="fl">0</span>, <span class="co"># single locus</span>
  save_locations <span class="op">=</span> <span class="cn">TRUE</span>,
  method <span class="op">=</span> <span class="st">"gui"</span> <span class="co"># open the model in SLiMgui</span>
<span class="op">)</span></code></pre></div>
<p>As specified, the SLiM run will save ancestry proportions in each population over time as well as the location of every individual who ever lived.</p>
</div>
<div id="7-re-capitulate-the-slim-run-as-an-individual-based-animation" class="section level4">
<h4 class="hasAnchor">
<a href="#7-re-capitulate-the-slim-run-as-an-individual-based-animation" class="anchor"></a>7. Re-capitulate the SLiM run as an individual-based animation</h4>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="reference/animate.html">animate</a></span><span class="op">(</span><span class="va">model</span>, nframes <span class="op">=</span> <span class="fl">200</span><span class="op">)</span></code></pre></div>
<p><img src="reference/figures/README-plot_gif-1.gif" alt="plot of chunk plot_gif"></p>
<p>Note that it is possible to simulate population splits and geneflows both by “physically” moving individuals of a population from one destination to the next across space but it is also possible to do this more abstractly (in instantaneous “jumps”) in situations where this is more appropriate or where simulating accurate movement is not necessary.</p>
<p>In this case, we simulated the split of populations <em>pop3</em> and <em>pop4</em> from <em>pop2</em> instantaneously, without explicitly tracing their movement. Compare this to the split of <em>pop5</em> from <em>pop1</em>, where we defined the population movement explicitly.</p>
</div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="links">
<h2>Links</h2>
<ul class="list-unstyled">
<li>Browse source code at <br><a href="https://github.com/bodkan/slendr/">https://​github.com/​bodkan/​slendr/​</a>
</li>
<li>Report a bug at <br><a href="https://github.com/bodkan/slendr/issues">https://​github.com/​bodkan/​slendr/​issues</a>
</li>
</ul>
</div>
<div class="license">
<h2>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>
<div class="developers">
<h2>Developers</h2>
<ul class="list-unstyled">
<li>Martin Petr <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0003-4879-8421" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>

  </div>
</div>


      <footer><div class="copyright">
  <p>Developed by Martin Petr.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
