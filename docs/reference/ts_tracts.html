<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><title>Extract ancestry tracts from a tree sequence (EXPERIMENTAL) — ts_tracts • slendr</title><!-- favicons --><link rel="icon" type="image/png" sizes="96x96" href="../favicon-96x96.png"><link rel="icon" type="”image/svg+xml”" href="../favicon.svg"><link rel="apple-touch-icon" sizes="180x180" href="../apple-touch-icon.png"><link rel="icon" sizes="any" href="../favicon.ico"><link rel="manifest" href="../site.webmanifest"><script src="../deps/jquery-3.6.0/jquery-3.6.0.min.js"></script><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><link href="../deps/bootstrap-5.3.1/bootstrap.min.css" rel="stylesheet"><script src="../deps/bootstrap-5.3.1/bootstrap.bundle.min.js"></script><link href="../deps/font-awesome-6.5.2/css/all.min.css" rel="stylesheet"><link href="../deps/font-awesome-6.5.2/css/v4-shims.min.css" rel="stylesheet"><script src="../deps/headroom-0.11.0/headroom.min.js"></script><script src="../deps/headroom-0.11.0/jQuery.headroom.min.js"></script><script src="../deps/bootstrap-toc-1.0.1/bootstrap-toc.min.js"></script><script src="../deps/clipboard.js-2.0.11/clipboard.min.js"></script><script src="../deps/search-1.0.0/autocomplete.jquery.min.js"></script><script src="../deps/search-1.0.0/fuse.min.js"></script><script src="../deps/search-1.0.0/mark.min.js"></script><!-- pkgdown --><script src="../pkgdown.js"></script><meta property="og:title" content="Extract ancestry tracts from a tree sequence (EXPERIMENTAL) — ts_tracts"><meta name="description" content="Extract a data frame with coordinates of ancestry tracts from a given tree sequence."><meta property="og:description" content="Extract a data frame with coordinates of ancestry tracts from a given tree sequence."><meta property="og:image" content="https://slendr.net/logo.png"></head><body>
    <a href="#main" class="visually-hidden-focusable">Skip to contents</a>


    <nav class="navbar navbar-expand-lg fixed-top bg-light" data-bs-theme="light" aria-label="Site navigation"><div class="container">

    <a class="navbar-brand me-2" href="../index.html">slendr</a>

    <small class="nav-text text-muted me-auto" data-bs-toggle="tooltip" data-bs-placement="bottom" title="">1.1.0</small>


    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbar" aria-controls="navbar" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>

    <div id="navbar" class="collapse navbar-collapse ms-3">
      <ul class="navbar-nav me-auto"><li class="nav-item"><a class="nav-link" href="../index.html"><span class="fa fa-home"></span></a></li>
<li class="active nav-item"><a class="nav-link" href="../reference/index.html"><span class="fa fa-question-circle"></span> Reference</a></li>
<li class="nav-item dropdown">
  <button class="nav-link dropdown-toggle" type="button" id="dropdown-articles" data-bs-toggle="dropdown" aria-expanded="false" aria-haspopup="true"><span class="fa fa-book"></span> Articles</button>
  <ul class="dropdown-menu" aria-labelledby="dropdown-articles"><li><a class="dropdown-item" href="../articles/vignette-00-installation.html">Installation instructions</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-01-tutorial.html">Introduction and basic tutorial</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-02-grid-model.html">Demes on a regular spatial grid</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-03-interactions.html">Programming dispersion dynamics</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-04-nonspatial-models.html">Traditional non-spatial models</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-05-tree-sequences.html">Tree sequence processing and statistics</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-06-locations.html">Spatially annotated tree sequences</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-07-backends.html">Simulating data with SLiM and msprime backends</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-08-nonslendr-tskit.html">Analyzing non-slendr tree sequences</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-09-paper.html">Examples from the slendr paper</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-10-tracts.html">Extracting true ancestry tracts</a></li>
    <li><a class="dropdown-item" href="../articles/vignette-11-extensions.html">Extending models with custom SLiM code</a></li>
  </ul></li>
<li class="nav-item"><a class="nav-link" href="../news/index.html">Changelog</a></li>
      </ul><ul class="navbar-nav"><li class="nav-item"><a class="external-link nav-link" href="https://github.com/bodkan/slendr/" aria-label="GitHub"><span class="fa fab fa-github fa-lg"></span></a></li>
<li class="nav-item"><a class="external-link nav-link" href="https://twitter.com/fleventy5"><span class="fa fa-twitter"></span></a></li>
      </ul></div>


  </div>
</nav><div class="container template-reference-topic">
<div class="row">
  <main id="main" class="col-md-9"><div class="page-header">
      <img src="../logo.png" class="logo" alt=""><h1>Extract ancestry tracts from a tree sequence (EXPERIMENTAL)</h1>
      <small class="dont-index">Source: <a href="https://github.com/bodkan/slendr/blob/HEAD/R/tspop.R" class="external-link"><code>R/tspop.R</code></a></small>
      <div class="d-none name"><code>ts_tracts.Rd</code></div>
    </div>

    <div class="ref-description section level2">
    <p>Extract a data frame with coordinates of ancestry tracts from a given tree sequence.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-usage">Usage<a class="anchor" aria-label="anchor" href="#ref-usage"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">ts_tracts</span><span class="op">(</span></span>
<span>  <span class="va">ts</span>,</span>
<span>  <span class="va">census</span>,</span>
<span>  squashed <span class="op">=</span> <span class="cn">TRUE</span>,</span>
<span>  source <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  target <span class="op">=</span> <span class="cn">NULL</span>,</span>
<span>  quiet <span class="op">=</span> <span class="cn">FALSE</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div class="section level2">
    <h2 id="arguments">Arguments<a class="anchor" aria-label="anchor" href="#arguments"></a></h2>


<dl><dt id="arg-ts">ts<a class="anchor" aria-label="anchor" href="#arg-ts"></a></dt>
<dd><p>Tree sequence object of the class <code>slendr_ts</code></p></dd>


<dt id="arg-census">census<a class="anchor" aria-label="anchor" href="#arg-census"></a></dt>
<dd><p>Census time. See the documentation linked in the Details for more
information. If a slendr-specific tree sequence was provided as <code>ts</code>,
the census time is expected to be given in slendr model-specific time units,
and must correspond to some gene-flow event encoded by the model.</p></dd>


<dt id="arg-squashed">squashed<a class="anchor" aria-label="anchor" href="#arg-squashed"></a></dt>
<dd><p>Should ancestry tracts be squashed (i.e., should continuous
tracts that can be traced to different ancestral nodes be merged)? Default
is <code>TRUE</code>. If <code>FALSE</code>, these effectively continuous ancestry
tracts will be split into individual segments, each assigned to a specific
ancestral node ID (recorded in a column <code>ancestor_id</code>).</p></dd>


<dt id="arg-source">source<a class="anchor" aria-label="anchor" href="#arg-source"></a></dt>
<dd><p>From which source population to extract tracts for? if <code>NULL</code>
(the default), ancestry tracts for all populations contributing gene flow
at the census time will be reported. Otherwise, ancestry tracts from only
specified source populations will be extracted. Note that this option is
ignored for non-slendr tree sequences!</p></dd>


<dt id="arg-target">target<a class="anchor" aria-label="anchor" href="#arg-target"></a></dt>
<dd><p>Similar purpose as <code>source</code> above, except that it filters
for tracts discovered in the target population(s)</p></dd>


<dt id="arg-quiet">quiet<a class="anchor" aria-label="anchor" href="#arg-quiet"></a></dt>
<dd><p>Should the default summary output of the <code>tspop</code> Python package
be silenced? Default is <code>FALSE</code>.</p></dd>

</dl></div>
    <div class="section level2">
    <h2 id="value">Value<a class="anchor" aria-label="anchor" href="#value"></a></h2>
    <p>A data frame containing coordinates of ancestry tracts</p>
    </div>
    <div class="section level2">
    <h2 id="details">Details<a class="anchor" aria-label="anchor" href="#details"></a></h2>
    <p>This function implements an R-friendly interface to an algorithm for
extracting ancestry tracts provided by the Python module tspop
<a href="https://tspop.readthedocs.io/en/latest/" class="external-link">https://tspop.readthedocs.io/en/latest/</a> and developed by Georgia Tsambos.
Please make sure to cite the paper which describes the algorithm in
detail: <a href="https://doi.org/10.1093/bioadv/vbad163" class="external-link">doi:10.1093/bioadv/vbad163</a>
.
For more technical details, see also the tutorial at:
<a href="https://tspop.readthedocs.io/en/latest/basicusage.html" class="external-link">https://tspop.readthedocs.io/en/latest/basicusage.html</a>.</p>
<p>In general, when using this function on a slendr-generated tree sequence,
please be aware that the output changes slightly to what you would get by
running the pure <code>tspop.get_pop_ancestry()</code> in Python. First,
<code>ts_tracts()</code> populates the output data frame with additional metadata
(such as names of individuals or populations). Additionally, for slendr models,
it is specifically designed to only return ancestry tracts originating to a
an ancestral population which contributed its ancestry during a gene-flow
event which started at a specific time (i.e., scheduled in a model via
the <code><a href="gene_flow.html">gene_flow()</a></code>) function. It does not return every single ancestry
tracts present in the tree sequence for every single sample node (and every
single potential ancestry population) as does the <code>tspop.get_pop_ancestry()</code>
Python method.</p>
<p>That said, when run on a tree sequence which does not originate from a slendr
simulation, the behavior of <code>ts_tracts()</code> is identical to that of the
underlying <code>tspop.get_pop_ancestry()</code>.</p>
<p>As of the current version of slendr, <code>ts_tracts()</code> only works for
slendr/msprime sequences but not on slendr/SLiM tree sequences. Support for
slendr-generated SLiM tree sequences is in development. Tracts from tree
sequences originating from non-slendr msprime and SLiM simulations are not
restricted in any way and, as mentioned in the previous paragraph,
<code>ts_tracts()</code> in this situation effectively reduces to the standard
<code>tspop.get_pop_ancestry()</code> call.</p>
    </div>

    <div class="section level2">
    <h2 id="ref-examples">Examples<a class="anchor" aria-label="anchor" href="#ref-examples"></a></h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="fu"><a href="init_env.html">init_env</a></span><span class="op">(</span>quiet <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load an example model with an already simulated tree sequence</span></span></span>
<span class="r-in"><span><span class="va">slendr_ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/models/introgression_msprime.trees"</span>, package <span class="op">=</span> <span class="st">"slendr"</span><span class="op">)</span></span></span>
<span class="r-in"><span><span class="va">model</span> <span class="op">&lt;-</span> <span class="fu"><a href="read_model.html">read_model</a></span><span class="op">(</span>path <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/system.file.html" class="external-link">system.file</a></span><span class="op">(</span><span class="st">"extdata/models/introgression"</span>, package <span class="op">=</span> <span class="st">"slendr"</span><span class="op">)</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># load the tree-sequence object from disk</span></span></span>
<span class="r-in"><span><span class="va">ts</span> <span class="op">&lt;-</span> <span class="fu"><a href="ts_read.html">ts_read</a></span><span class="op">(</span>file <span class="op">=</span> <span class="va">slendr_ts</span>, model <span class="op">=</span> <span class="va">model</span><span class="op">)</span></span></span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># extract Neanderthal ancestry tracts (i.e. those corresponding to the</span></span></span>
<span class="r-in"><span><span class="co"># census event at the gene-flow time at 55000 kya as scheduled by</span></span></span>
<span class="r-in"><span><span class="co"># the simulation which produced the tree sequence)</span></span></span>
<span class="r-in"><span><span class="va">nea_tracts</span> <span class="op">&lt;-</span> <span class="fu">ts_tracts</span><span class="op">(</span><span class="va">ts</span>, census <span class="op">=</span> <span class="fl">55000</span>, source <span class="op">=</span> <span class="st">"NEA"</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-out co"><span class="r-pr">#&gt;</span> PopAncestry summary</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of ancestral populations: 	4</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of sample chromosomes: 		26</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Number of ancestors: 			763</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Total length of genomes: 		130000000.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> Ancestral coverage: 			120000000.000000</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> </span>
<span class="r-in"><span><span class="va">nea_tracts</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># A tibble: 42 × 10</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    name  haplotype  time pop   source_pop    left   right length source_pop_id</span>
<span class="r-out co"><span class="r-pr">#&gt;</span>    <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span>     <span style="color: #949494; font-style: italic;">&lt;int&gt;</span> <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span> <span style="color: #949494; font-style: italic;">&lt;chr&gt;</span> <span style="color: #949494; font-style: italic;">&lt;fct&gt;</span>        <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>   <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>  <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span>         <span style="color: #949494; font-style: italic;">&lt;dbl&gt;</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 1</span> EUR_1         1     0 EUR   NEA          <span style="text-decoration: underline;">44</span>049  <span style="text-decoration: underline;">101</span>210  <span style="text-decoration: underline;">57</span>161             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 2</span> EUR_1         1     0 EUR   NEA         <span style="text-decoration: underline;">244</span>041  <span style="text-decoration: underline;">280</span>650  <span style="text-decoration: underline;">36</span>609             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 3</span> EUR_1         1     0 EUR   NEA        4<span style="text-decoration: underline;">636</span>048 4<span style="text-decoration: underline;">736</span>790 <span style="text-decoration: underline;">100</span>742             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 4</span> EUR_1         1     0 EUR   NEA        4<span style="text-decoration: underline;">756</span>344 4<span style="text-decoration: underline;">850</span>072  <span style="text-decoration: underline;">93</span>728             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 5</span> EUR_1         2     0 EUR   NEA         <span style="text-decoration: underline;">106</span>906  <span style="text-decoration: underline;">268</span>610 <span style="text-decoration: underline;">161</span>704             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 6</span> EUR_1         2     0 EUR   NEA        1<span style="text-decoration: underline;">420</span>672 1<span style="text-decoration: underline;">432</span>252  <span style="text-decoration: underline;">11</span>580             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 7</span> EUR_1         2     0 EUR   NEA        3<span style="text-decoration: underline;">438</span>894 3<span style="text-decoration: underline;">511</span>366  <span style="text-decoration: underline;">72</span>472             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 8</span> EUR_1         2     0 EUR   NEA        3<span style="text-decoration: underline;">624</span>298 3<span style="text-decoration: underline;">682</span>434  <span style="text-decoration: underline;">58</span>136             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;"> 9</span> EUR_1         2     0 EUR   NEA        4<span style="text-decoration: underline;">139</span>989 4<span style="text-decoration: underline;">239</span>794  <span style="text-decoration: underline;">99</span>805             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #BCBCBC;">10</span> EUR_1         2     0 EUR   NEA        4<span style="text-decoration: underline;">318</span>138 4<span style="text-decoration: underline;">351</span>616  <span style="text-decoration: underline;">33</span>478             2</span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 32 more rows</span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> <span style="color: #949494;"># ℹ 1 more variable: node_id &lt;dbl&gt;</span></span>
</code></pre></div>
    </div>
  </main><aside class="col-md-3"><nav id="toc" aria-label="Table of contents"><h2>On this page</h2>
    </nav></aside></div>


    <footer><div class="pkgdown-footer-left">
  <p>Developed by Martin Petr.</p>
</div>

<div class="pkgdown-footer-right">
  <p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.1.3.</p>
</div>

    </footer></div>





  </body></html>

